---
title: "ValeursFoncières"
author: "Valentin"
date: "2/12/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE)
```

```{r appel des librairies}
library(data.table)
library(dplyr)
library(tidyr)
library(readr)
library(DT)
library(tidyverse)
```

```{r Recuperation des donnees}
VF <- fread("https://www.data.gouv.fr/fr/datasets/r/3004168d-bec4-44d9-a781-ef16f41856a2")
```

```{r Suppression colonnes inutiles}
VF$`Code service CH` <- NULL
VF$`Reference document` <- NULL
VF$`1 Articles CGI` <- NULL
VF$`2 Articles CGI` <- NULL
VF$`3 Articles CGI` <- NULL
VF$`4 Articles CGI` <- NULL
VF$`5 Articles CGI` <- NULL
VF$`2eme lot` <- NULL
VF$`Surface Carrez du 2eme lot` <- NULL
VF$`3eme lot` <- NULL
VF$`Surface Carrez du 3eme lot` <- NULL
VF$`4eme lot` <- NULL
VF$`Surface Carrez du 4eme lot` <- NULL
VF$`5eme lot` <- NULL
VF$`Surface Carrez du 5eme lot` <- NULL
```

```{r mise en nombre de certaines variables}
VF$`Valeur fonciere` <- as.numeric(sub(",", ".", VF$`Valeur fonciere`))
VF$`Surface reelle bati` <- as.numeric(VF$`Surface reelle bati`)
VF$`Surface terrain` <- as.numeric(VF$`Surface terrain`)
```

```{r appel du jeu de donnees}
View(VF)
```

```{r verification de la nature des variables}
str(VF)
```

```{r mise en data frame}
VF <- as.data.frame(VF)
```

# Test pour la commune de SURZUR

```{r filtre pour la commune}
SurzurData <- filter(VF, Commune == "SURZUR")
```

```{r création d'un jeu de donnees sans doublons}
SurzurData1 <- SurzurData %>% distinct(`Date mutation`, `Valeur fonciere`, Commune, `Code commune`, .keep_all = TRUE)
```

```{r verification absence de doublons}
#duplicated(SurzurData1)
```

```{r appel de la fonction calcul}
summary(SurzurData1$`Valeur fonciere`)
summary(SurzurData1$`Surface terrain`)
```


```{r création d'un jeu de donnees sans doublons pour VF}
VF1 <- VF %>% distinct(`Date mutation`, `Valeur fonciere`, Commune, `Code commune`, .keep_all = TRUE)
VF2 <- filter(VF1, `Valeur fonciere` > 0)
```

```{r}
summary(VF1$`Valeur fonciere`)
summary(VF1$`Surface terrain`)
```



