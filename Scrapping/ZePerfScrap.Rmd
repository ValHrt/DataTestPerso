---
title: "ZePerf Scrapping"
author: "Valentin Henriot"
date: "6/6/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE)
```

```{r}
library(stringr)
library(rvest)
library(htmltab)
library(tidyverse)
library(rlist)
library(stringi)
library(WikipediR)
library(ggplot2)
library(reshape2)
library(DataCombine)
```

# Script de base à améliorer

```{r}
urlzp = read_html("http://www.zeperfs.com/fiche1583-bmw-120-d.htm") ## Appeler l'URL avec les données du véhicule souhaité
```

```{r}
TestZP <- urlzp %>%
  html_node('table') %>%
  html_table() ## Commande de scrapping
```

```{r}
TestZP2 <- TestZP[,-3] 
TestZP3 <- TestZP2[-2:-5,] ## Supprimer les données inutiles générées
```

```{r}
TestZP3$X2 <- gsub("@zeperfs.com", "", TestZP3$X2)
TestZP3$X2 <- gsub("km/h", "", TestZP3$X2)
TestZP3$X2 <- gsub("m.", "", TestZP3$X2)
TestZP3$X2 <- gsub("s.", "", TestZP3$X2)
```

```{r}
BMW120DT1 <- TestZP3 %>% 
  separate_rows(X1, sep = ":") ## Séparer les données pour avoir une donnée par ligne

BMW120DT1 <- BMW120DT1[-49,]
BMW120DT1 <- BMW120DT1[,-2]

BMW120DT1 <- as.data.frame(BMW120DT1)
```

```{r}
BMW120DT2 <- TestZP3 %>% 
  separate_rows(X2, sep = " ") ## Séparer les données pour avoir une donnée par ligne

BMW120DT2 <- BMW120DT2[,-1]

BMW120DT2 <- gsub(pattern = "\\s",   
     replacement = "",
     x = BMW120DT2) ## Pour supprimer tous les espaces

BMW120DT2[BMW120DT2 == "" ] <- NA ## Remplacer les cellules vides par des NA

is.na(BMW120DT2) ## Test pour voir le nombre de valeurs manquantes

BMW120DT2 <- na.omit(BMW120DT2) ## Suppression valeurs manquantes

BMW120DT2 <- as.data.frame(BMW120DT2)

BMW120DT2 <- BMW120DT2[-49:-60,]
```

```{r}
BMW120D <- cbind(BMW120DT1, BMW120DT2)
```